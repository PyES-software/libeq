import numpy as np
import numpy.testing as npt

from libeq import SolverData, EqSolver, species_concentration
from libeq.utils import objective_function


def test_solid_aluminium():
    real_csol, real_csolid, real_sindex = _alum_result()

    FOBJ_TOLERANCE = 1e-7
    data = SolverData.load_from_pyes('tests/data/aluminium_alkaline.json')
    freec, log_beta, log_ks, saturation_index, analc = EqSolver(data, mode="distribution")

    c_soluble = freec[:,:2]
    c_solids  = freec[:,-1][:, None]

    number_components = 2
    stoichx = np.vstack((np.eye(number_components, dtype=int), data.stoichiometry.T))
    freecx = species_concentration(c_soluble, data.log_beta, data.stoichiometry, full=True)
    npt.assert_allclose(freecx, real_csol, atol=FOBJ_TOLERANCE)   
    npt.assert_allclose(c_solids, real_csolid, atol=FOBJ_TOLERANCE)   
    # npt.assert_allclose(real_sindex, saturation_index, atol=FOBJ_TOLERANCE)   

    f = objective_function(analc, freecx, stoichx, c_solids, data.solid_stoichiometry.T, log_ks)
    npt.assert_allclose(f, np.zeros_like(f), atol=FOBJ_TOLERANCE)   


### Beginning Calculation ###
# 
# Loading data...
# 
# DATA LOADED!
# 
# Calculating distribution of the species...
# 
# soluble species concentration
# Species Conc. [mol/L]            Al             H      (Al)(OH)     (Al)(OH)2     (Al)(OH)3     (Al)(OH)4          (OH)
# p[H] I                                                                                                                 
# 2.0  5.000045e-03      9.989960e-09  1.000000e-02  9.989960e-12  5.006840e-14  9.989960e-18  9.989960e-24  1.000000e-12
# 2.1  3.971686e-03      9.987347e-09  7.943282e-03  1.257333e-11  7.933232e-14  1.992738e-17  2.508708e-23  1.258925e-12
# 2.2  3.154832e-03      9.984051e-09  6.309573e-03  1.582365e-11  1.256918e-13  3.974722e-17  6.299510e-23  1.584893e-12
# 2.3  2.505981e-03      9.979888e-09  5.011872e-03  1.991250e-11  1.991250e-13  7.927307e-17  1.581706e-22  1.995262e-12
# 2.4  1.990581e-03      9.974629e-09  3.981072e-03  2.505514e-11  3.154255e-13  1.580872e-16  3.970971e-22  2.511886e-12
# 2.5  1.581184e-03      9.967979e-09  3.162278e-03  3.152152e-11  4.995824e-13  3.152152e-16  9.967979e-22  3.162278e-12
# 2.6  1.255988e-03      9.959559e-09  2.511886e-03  3.964972e-11  7.911159e-13  6.284057e-16  2.501728e-21  3.981072e-12
# 2.7  9.976760e-04      9.948884e-09  1.995262e-03  4.986254e-11  1.252490e-12  1.252490e-15  6.277321e-21  5.011872e-12
# 2.8  7.924914e-04      9.935327e-09  1.584893e-03  6.268768e-11  1.982358e-12  2.495641e-15  1.574643e-20  6.309573e-12
# 2.9  6.295075e-04      9.918077e-09  1.258925e-03  7.878208e-11  3.136371e-12  4.970813e-15  3.948457e-20  7.943282e-12
# 3.0  5.000447e-04      9.896070e-09  1.000000e-03  9.896070e-11  4.959784e-12  9.896070e-15  9.896070e-20  1.000000e-11
# 3.1  3.972088e-04      9.867912e-09  7.943282e-04  1.242297e-10  7.838361e-12  1.968907e-14  2.478707e-19  1.258925e-11
# 3.2  3.155232e-04      9.831761e-09  6.309573e-04  1.558229e-10  1.237745e-11  3.914094e-14  6.203421e-19  1.584893e-11
# 3.3  2.506381e-04      9.785159e-09  5.011872e-04  1.952396e-10  1.952396e-11  7.772628e-14  1.550843e-18  1.995262e-11
# 3.4  1.990979e-04      9.724817e-09  3.981072e-04  2.442764e-10  3.075257e-11  1.541280e-13  3.871519e-18  2.511886e-11
# 3.5  1.581579e-04      9.646306e-09  3.162278e-04  3.050430e-10  4.834605e-11  3.050430e-13  9.646306e-18  3.162278e-11
# 3.6  1.256381e-04      9.543650e-09  2.511886e-04  3.799396e-10  7.580791e-11  6.021636e-13  2.397257e-17  3.981072e-11
# 3.7  9.980648e-05      9.408808e-09  1.995262e-04  4.715575e-10  1.184499e-10  1.184499e-12  5.936557e-17  5.011872e-11
# 3.8  7.928749e-05      9.231057e-09  1.584893e-04  5.824403e-10  1.841838e-10  2.318737e-12  1.463024e-16  6.309573e-11
# 3.9  6.298837e-05      8.996391e-09  1.258925e-04  7.146087e-10  2.844909e-10  4.508876e-12  3.581528e-16  7.943282e-11
# 4.0  5.004110e-05      8.687200e-09  1.000000e-04  8.687200e-10  4.353914e-10  8.687200e-12  8.687200e-16  1.000000e-10
# 4.1  3.975616e-05      8.282802e-09  7.943282e-05  1.042743e-09  6.579264e-10  1.652636e-11  2.080546e-15  1.258925e-10
# 4.2  3.158582e-05      7.761784e-09  6.309573e-05  1.230160e-09  9.771507e-10  3.090022e-11  4.897355e-15  1.584893e-10
# 4.3  2.509499e-05      7.107334e-09  5.011872e-05  1.418100e-09  1.418100e-09  5.645556e-11  1.126437e-14  1.995262e-10
# 4.4  1.993808e-05      6.316045e-09  3.981072e-05  1.586519e-09  1.997309e-09  1.001026e-10  2.514463e-14  2.511886e-10
# 4.5  1.584066e-05      5.408189e-09  3.162278e-05  1.710220e-09  2.710515e-09  1.710220e-10  5.408189e-14  3.162278e-10
# 4.6  1.258487e-05      4.433496e-09  2.511886e-05  1.765007e-09  3.521651e-09  2.797347e-10  1.113644e-13  3.981072e-10
# 4.7  9.991965e-06      2.511886e-09  1.995262e-05  1.258925e-09  3.162278e-09  3.162278e-10  1.584893e-13  5.011872e-10
# 4.8  7.933291e-06      1.258925e-09  1.584893e-05  7.943282e-10  2.511886e-09  3.162278e-10  1.995262e-13  6.309573e-10
# 4.9  6.299864e-06      6.309573e-10  1.258925e-05  5.011872e-10  1.995262e-09  3.162278e-10  2.511886e-13  7.943282e-10
# 5.0  5.003348e-06      3.162278e-10  1.000000e-05  3.162278e-10  1.584893e-09  3.162278e-10  3.162278e-13  1.000000e-09
# 5.1  3.974013e-06      1.584893e-10  7.943282e-06  1.995262e-10  1.258925e-09  3.162278e-10  3.981072e-13  1.258925e-09
# 5.2  3.156689e-06      7.943282e-11  6.309573e-06  1.258925e-10  1.000000e-09  3.162278e-10  5.011872e-13  1.584893e-09
# 5.3  2.507669e-06      3.981072e-11  5.011872e-06  7.943282e-11  7.943282e-10  3.162278e-10  6.309573e-13  1.995262e-09
# 5.4  1.992298e-06      1.995262e-11  3.981072e-06  5.011872e-11  6.309573e-10  3.162278e-10  7.943282e-13  2.511886e-09
# 5.5  1.583079e-06      1.000000e-11  3.162278e-06  3.162278e-11  5.011872e-10  3.162278e-10  1.000000e-12  3.162278e-09
# 5.6  1.258196e-06      5.011872e-12  2.511886e-06  1.995262e-11  3.981072e-10  3.162278e-10  1.258925e-12  3.981072e-09
# 5.7  1.000332e-06      2.511886e-12  1.995262e-06  1.258925e-11  3.162278e-10  3.162278e-10  1.584893e-12  5.011872e-09
# 5.8  7.957495e-07      1.258925e-12  1.584893e-06  7.943282e-12  2.511886e-10  3.162278e-10  1.995262e-12  6.309573e-09
# 5.9  6.335482e-07      6.309573e-13  1.258925e-06  5.011872e-12  1.995262e-10  3.162278e-10  2.511886e-12  7.943282e-09
# 6.0  5.050886e-07      3.162278e-13  1.000000e-06  3.162278e-12  1.584893e-10  3.162278e-10  3.162278e-12  1.000000e-08
# 6.1  4.035284e-07      1.584893e-13  7.943282e-07  1.995262e-12  1.258925e-10  3.162278e-10  3.981072e-12  1.258925e-08
# 6.2  3.234585e-07      7.943282e-14  6.309573e-07  1.258925e-12  1.000000e-10  3.162278e-10  5.011872e-12  1.584893e-08
# 6.3  2.606146e-07      3.981072e-14  5.011872e-07  7.943282e-13  7.943282e-11  3.162278e-10  6.309573e-12  1.995262e-08
# 6.4  2.116496e-07      1.995262e-14  3.981072e-07  5.011872e-13  6.309573e-11  3.162278e-10  7.943282e-12  2.511886e-08
# 6.5  1.739560e-07      1.000000e-14  3.162278e-07  3.162278e-13  5.011872e-11  3.162278e-10  1.000000e-11  3.162278e-08
# 6.6  1.455263e-07      5.011872e-15  2.511886e-07  1.995262e-13  3.981072e-11  3.162278e-10  1.258925e-11  3.981072e-08
# 6.7  1.248465e-07      2.511886e-15  1.995262e-07  1.258925e-13  3.162278e-11  3.162278e-10  1.584893e-11  5.011872e-08
# 6.8  1.108152e-07      1.258925e-15  1.584893e-07  7.943282e-14  2.511886e-11  3.162278e-10  1.995262e-11  6.309573e-08
# 6.9  1.026853e-07      6.309573e-16  1.258925e-07  5.011872e-14  1.995262e-11  3.162278e-10  2.511886e-11  7.943282e-08
# 7.0  1.000238e-07      3.162278e-16  1.000000e-07  3.162278e-14  1.584893e-11  3.162278e-10  3.162278e-11  1.000000e-07
# 7.1  1.026889e-07      1.584893e-16  7.943282e-08  1.995262e-14  1.258925e-11  3.162278e-10  3.981072e-11  1.258925e-07
# 7.2  1.108226e-07      7.943282e-17  6.309573e-08  1.258925e-14  1.000000e-11  3.162278e-10  5.011872e-11  1.584893e-07
# 7.3  1.248580e-07      3.981072e-17  5.011872e-08  7.943282e-15  7.943282e-12  3.162278e-10  6.309573e-11  1.995262e-07
# 7.4  1.455426e-07      1.995262e-17  3.981072e-08  5.011872e-15  6.309573e-12  3.162278e-10  7.943282e-11  2.511886e-07
# 7.5  1.739778e-07      1.000000e-17  3.162278e-08  3.162278e-15  5.011872e-12  3.162278e-10  1.000000e-10  3.162278e-07
# 7.6  2.116780e-07      5.011872e-18  2.511886e-08  1.995262e-15  3.981072e-12  3.162278e-10  1.258925e-10  3.981072e-07
# 7.7  2.606508e-07      2.511886e-18  1.995262e-08  1.258925e-15  3.162278e-12  3.162278e-10  1.584893e-10  5.011872e-07
# 7.8  3.235042e-07      1.258925e-18  1.584893e-08  7.943282e-16  2.511886e-12  3.162278e-10  1.995262e-10  6.309573e-07
# 7.9  4.035853e-07      6.309573e-19  1.258925e-08  5.011872e-16  1.995262e-12  3.162278e-10  2.511886e-10  7.943282e-07
# 8.0  5.051589e-07      3.162278e-19  1.000000e-08  3.162278e-16  1.584893e-12  3.162278e-10  3.162278e-10  1.000000e-06
# 8.1  6.336340e-07      1.584893e-19  7.943282e-09  1.995262e-16  1.258925e-12  3.162278e-10  3.981072e-10  1.258925e-06
# 8.2  7.958525e-07      7.943282e-20  6.309573e-09  1.258925e-16  1.000000e-12  3.162278e-10  5.011872e-10  1.584893e-06
# 8.3  1.000453e-06      3.981072e-20  5.011872e-09  7.943282e-17  7.943282e-13  3.162278e-10  6.309573e-10  1.995262e-06
# 8.4  1.258331e-06      1.995262e-20  3.981072e-09  5.011872e-17  6.309573e-13  3.162278e-10  7.943282e-10  2.511886e-06
# 8.5  1.583220e-06      1.000000e-20  3.162278e-09  3.162278e-17  5.011872e-13  3.162278e-10  1.000000e-09  3.162278e-06
# 8.6  1.992421e-06      5.011872e-21  2.511886e-09  1.995262e-17  3.981072e-13  3.162278e-10  1.258925e-09  3.981072e-06
# 8.7  2.507726e-06      2.511886e-21  1.995262e-09  1.258925e-17  3.162278e-13  3.162278e-10  1.584893e-09  5.011872e-06
# 8.8  3.156577e-06      1.258925e-21  1.584893e-09  7.943282e-18  2.511886e-13  3.162278e-10  1.995262e-09  6.309573e-06
# 8.9  3.973527e-06      6.309573e-22  1.258925e-09  5.011872e-18  1.995262e-13  3.162278e-10  2.511886e-09  7.943282e-06
# 9.0  5.002081e-06      3.162278e-22  1.000000e-09  3.162278e-18  1.584893e-13  3.162278e-10  3.162278e-09  1.000000e-05
# 9.1  6.297015e-06      1.584893e-22  7.943282e-10  1.995262e-18  1.258925e-13  3.162278e-10  3.981072e-09  1.258925e-05
# 9.2  7.927287e-06      7.943282e-23  6.309573e-10  1.258925e-18  1.000000e-13  3.162278e-10  5.011872e-09  1.584893e-05
# 9.3  9.979717e-06      3.981072e-23  5.011872e-10  7.943282e-19  7.943282e-14  3.162278e-10  6.309573e-09  1.995262e-05
# 9.4  1.256360e-05      1.995262e-23  3.981072e-10  5.011872e-19  6.309573e-14  3.162278e-10  7.943282e-09  2.511886e-05
# 9.5  1.581639e-05      9.693419e-24  3.162278e-10  3.065328e-19  4.858218e-14  3.065328e-10  9.693419e-09  3.162278e-05
# 9.6  1.991036e-05      3.883510e-24  2.511886e-10  1.546053e-19  3.084782e-14  2.450329e-10  9.754936e-09  3.981072e-05
# 9.7  2.506436e-05      1.553886e-24  1.995262e-10  7.787878e-20  1.956227e-14  1.956227e-10  9.804358e-09  5.011872e-05
# 9.8  3.155287e-05      6.211126e-25  1.584893e-10  3.918956e-20  1.239283e-14  1.560164e-10  9.843971e-09  6.309573e-05
# 9.9  3.972141e-05      2.480655e-25  1.258925e-10  1.970454e-20  7.844519e-15  1.243273e-10  9.875665e-09  7.943282e-05
# 10.0 5.000500e-05      9.900985e-26  1.000000e-10  9.900985e-21  4.962247e-15  9.900985e-11  9.900985e-09  1.000000e-04
# 10.1 6.295127e-05      3.949697e-26  7.943282e-11  4.972374e-21  3.137356e-15  7.880681e-11  9.921190e-09  1.258925e-04
# 10.2 7.924966e-05      1.574956e-26  6.309573e-11  2.496136e-21  1.982752e-15  6.270011e-11  9.937298e-09  1.584893e-04
# 10.3 9.976812e-05      6.278108e-27  5.011872e-11  1.252647e-21  1.252647e-15  4.986878e-11  9.950130e-09  1.995262e-04
# 10.4 1.255993e-04      2.501926e-27  3.981072e-11  6.284554e-22  7.911784e-16  3.965285e-11  9.960346e-09  2.511886e-04
# 10.5 1.581189e-04      9.968476e-28  3.162278e-11  3.152309e-22  4.996073e-16  3.152309e-11  9.968476e-09  3.162278e-04
# 10.6 1.990586e-04      3.971097e-28  2.511886e-11  1.580922e-22  3.154354e-16  2.505593e-11  9.974944e-09  3.981072e-04
# 10.7 2.505986e-04      1.581737e-28  1.995262e-11  7.927465e-23  1.991289e-16  1.991289e-11  9.980087e-09  5.011872e-04
# 10.8 3.154837e-04      6.299589e-29  1.584893e-11  3.974772e-23  1.256933e-16  1.582385e-11  9.984176e-09  6.309573e-04
# 10.9 3.971691e-04      2.508728e-29  1.258925e-11  1.992754e-23  7.933295e-17  1.257343e-11  9.987426e-09  7.943282e-04
# 11.0 5.000050e-04      9.990010e-30  1.000000e-11  9.990010e-24  5.006865e-17  9.990010e-12  9.990010e-09  1.000000e-03
# 11.1 6.294677e-04      3.977912e-30  7.943282e-12  5.007894e-24  3.159768e-17  7.936978e-12  9.992063e-09  1.258925e-03
# 11.2 7.924516e-04      1.583894e-30  6.309573e-12  2.510303e-24  1.994004e-17  6.305595e-12  9.993694e-09  1.584893e-03
# 11.3 9.976362e-04      6.306413e-31  5.011872e-12  1.258295e-24  1.258295e-17  5.009362e-12  9.994991e-09  1.995262e-03
# 11.4 1.255948e-03      2.510887e-31  3.981072e-12  6.307063e-25  7.940121e-18  3.979487e-12  9.996021e-09  2.511886e-03
# 11.5 1.581144e-03      9.996839e-32  3.162278e-12  3.161278e-25  5.010288e-18  3.161278e-12  9.996839e-09  3.162278e-03
# 11.6 1.990541e-03      3.980072e-32  2.511886e-12  1.584495e-25  3.161484e-18  2.511256e-12  9.997489e-09  3.981072e-03
# 11.7 2.505941e-03      1.584577e-32  1.995262e-12  7.941698e-26  1.994864e-18  1.994864e-12  9.998005e-09  5.011872e-03
# 11.8 3.154792e-03      6.308574e-33  1.584893e-12  3.980441e-26  1.258726e-18  1.584642e-12  9.998415e-09  6.309573e-03
# 11.9 3.971646e-03      2.511570e-33  1.258925e-12  1.995011e-26  7.942282e-19  1.258767e-12  9.998741e-09  7.943282e-03
# 12.0 5.000005e-03      9.999000e-34  1.000000e-12  9.999000e-27  5.011371e-19  9.999000e-13  9.999000e-09  1.000000e-02
# 
# solid species
#                   Prec.(Al)(OH)3   SI(Al)(OH)3     (Al)(OH)3
# p[H] I                                                      
# 2.0  5.000045e-03                 3.159103e-08  0.000000e+00
# 2.1  3.971686e-03                 6.301590e-08  0.000000e+00
# 2.2  3.154832e-03                 1.256918e-07  0.000000e+00
# 2.3  2.505981e-03                 2.506835e-07  0.000000e+00
# 2.4  1.990581e-03                 4.999157e-07  0.000000e+00
# 2.5  1.581184e-03                 9.967979e-07  0.000000e+00
# 2.6  1.255988e-03                 1.987193e-06  0.000000e+00
# 2.7  9.976760e-04                 3.960722e-06  0.000000e+00
# 2.8  7.924914e-04                 7.891911e-06  0.000000e+00
# 2.9  6.295075e-04                 1.571909e-05  0.000000e+00
# 3.0  5.000447e-04                 3.129412e-05  0.000000e+00
# 3.1  3.972088e-04                 6.226232e-05  0.000000e+00
# 3.2  3.155232e-04                 1.237745e-04  0.000000e+00
# 3.3  2.506381e-04                 2.457921e-04  0.000000e+00
# 3.4  1.990979e-04                 4.873954e-04  0.000000e+00
# 3.5  1.581579e-04                 9.646306e-04  0.000000e+00
# 3.6  1.256381e-04                 1.904209e-03  0.000000e+00
# 3.7  9.980648e-05                 3.745714e-03  0.000000e+00
# 3.8  7.928749e-05                 7.332489e-03  0.000000e+00
# 3.9  6.298837e-05                 1.425832e-02  0.000000e+00
# 4.0  5.004110e-05                 2.747134e-02  0.000000e+00
# 4.1  3.975616e-05                 5.226095e-02  0.000000e+00
# 4.2  3.158582e-05                 9.771507e-02  0.000000e+00
# 4.3  2.509499e-05                 1.785282e-01  0.000000e+00
# 4.4  1.993808e-05                 3.165521e-01  0.000000e+00
# 4.5  1.584066e-05                 5.408189e-01  0.000000e+00
# 4.6  1.258487e-05                 8.845988e-01  0.000000e+00
# 4.7  9.991965e-06              *  1.000000e+00  2.750524e-09
# 4.8  7.933291e-06              *  1.000000e+00  5.118433e-09
# 4.9  6.299864e-06              *  1.000000e+00  6.556114e-09
# 5.0  5.003348e-06              *  1.000000e+00  7.466107e-09
# 5.1  3.974013e-06              *  1.000000e+00  8.066433e-09
# 5.2  3.156689e-06              *  1.000000e+00  8.477946e-09
# 5.3  2.507669e-06              *  1.000000e+00  8.769570e-09
# 5.4  1.992298e-06              *  1.000000e+00  8.981949e-09
# 5.5  1.583079e-06              *  1.000000e+00  9.139962e-09
# 5.6  1.258196e-06              *  1.000000e+00  9.259442e-09
# 5.7  1.000332e-06              *  1.000000e+00  9.350858e-09
# 5.8  7.957495e-07              *  1.000000e+00  9.421386e-09
# 5.9  6.335482e-07              *  1.000000e+00  9.476091e-09
# 6.0  5.050886e-07              *  1.000000e+00  9.518642e-09
# 6.1  4.035284e-07              *  1.000000e+00  9.551745e-09
# 6.2  3.234585e-07              *  1.000000e+00  9.577422e-09
# 6.3  2.606146e-07              *  1.000000e+00  9.597196e-09
# 6.4  2.116496e-07              *  1.000000e+00  9.612212e-09
# 6.5  1.739560e-07              *  1.000000e+00  9.623327e-09
# 6.6  1.455263e-07              *  1.000000e+00  9.631168e-09
# 6.7  1.248465e-07              *  1.000000e+00  9.636172e-09
# 6.8  1.108152e-07              *  1.000000e+00  9.638620e-09
# 6.9  1.026853e-07              *  1.000000e+00  9.638650e-09
# 7.0  1.000238e-07              *  1.000000e+00  9.636269e-09
# 7.1  1.026889e-07              *  1.000000e+00  9.631352e-09
# 7.2  1.108226e-07              *  1.000000e+00  9.623641e-09
# 7.3  1.248580e-07              *  1.000000e+00  9.612725e-09
# 7.4  1.455426e-07              *  1.000000e+00  9.598025e-09
# 7.5  1.739778e-07              *  1.000000e+00  9.578757e-09
# 7.6  2.116780e-07              *  1.000000e+00  9.553897e-09
# 7.7  2.606508e-07              *  1.000000e+00  9.522119e-09
# 7.8  3.235042e-07              *  1.000000e+00  9.481733e-09
# 7.9  4.035853e-07              *  1.000000e+00  9.430588e-09
# 8.0  5.051589e-07              *  1.000000e+00  9.365959e-09
# 8.1  6.336340e-07              *  1.000000e+00  9.284406e-09
# 8.2  7.958525e-07              *  1.000000e+00  9.181585e-09
# 8.3  1.000453e-06              *  1.000000e+00  9.052020e-09
# 8.4  1.258331e-06              *  1.000000e+00  8.888813e-09
# 8.5  1.583220e-06              *  1.000000e+00  8.683271e-09
# 8.6  1.992421e-06              *  1.000000e+00  8.424449e-09
# 8.7  2.507726e-06              *  1.000000e+00  8.098563e-09
# 8.8  3.156577e-06              *  1.000000e+00  7.688259e-09
# 8.9  3.973527e-06              *  1.000000e+00  7.171686e-09
# 9.0  5.002081e-06              *  1.000000e+00  6.521336e-09
# 9.1  6.297015e-06              *  1.000000e+00  5.702575e-09
# 9.2  7.927287e-06              *  1.000000e+00  4.671800e-09
# 9.3  9.979717e-06              *  1.000000e+00  3.374119e-09
# 9.4  1.256360e-05              *  1.000000e+00  1.740427e-09
# 9.5  1.581639e-05                 9.693419e-01  0.000000e+00
# 9.6  1.991036e-05                 7.748621e-01  0.000000e+00
# 9.7  2.506436e-05                 6.186132e-01  0.000000e+00
# 9.8  3.155287e-05                 4.933673e-01  0.000000e+00
# 9.9  3.972141e-05                 3.931573e-01  0.000000e+00
# 10.0 5.000500e-05                 3.130966e-01  0.000000e+00
# 10.1 6.295127e-05                 2.492090e-01  0.000000e+00
# 10.2 7.924966e-05                 1.982752e-01  0.000000e+00
# 10.3 9.976812e-05                 1.576989e-01  0.000000e+00
# 10.4 1.255993e-04                 1.253933e-01  0.000000e+00
# 10.5 1.581189e-04                 9.968476e-02  0.000000e+00
# 10.6 1.990586e-04                 7.923379e-02  0.000000e+00
# 10.7 2.505986e-04                 6.297009e-02  0.000000e+00
# 10.8 3.154837e-04                 5.003942e-02  0.000000e+00
# 10.9 3.971691e-04                 3.976066e-02  0.000000e+00
# 11.0 5.000050e-04                 3.159119e-02  0.000000e+00
# 11.1 6.294677e-04                 2.509893e-02  0.000000e+00
# 11.2 7.924516e-04                 1.994004e-02  0.000000e+00
# 11.3 9.976362e-04                 1.584099e-02  0.000000e+00
# 11.4 1.255948e-03                 1.258424e-02  0.000000e+00
# 11.5 1.581144e-03                 9.996839e-03  0.000000e+00
# 11.6 1.990541e-03                 7.941288e-03  0.000000e+00
# 11.7 2.505941e-03                 6.308315e-03  0.000000e+00
# 11.8 3.154792e-03                 5.011078e-03  0.000000e+00
# 11.9 3.971646e-03                 3.980571e-03  0.000000e+00
# 12.0 5.000005e-03                 3.161961e-03  0.000000e+00
# 
# formation constants
# No formation constants to print
# 
# solubility products
# No solubility products to print
# 
# Elapsed Time: 0.22268 s
# 
# ### FINISHED ###

def _alum_result():
    real_csol = np.array([[9.989960e-09,  1.000000e-02,  9.989960e-12,  5.006840e-14,  9.989960e-18,  9.989960e-24,  1.000000e-12],
                          [9.987347e-09,  7.943282e-03,  1.257333e-11,  7.933232e-14,  1.992738e-17,  2.508708e-23,  1.258925e-12],
                          [9.984051e-09,  6.309573e-03,  1.582365e-11,  1.256918e-13,  3.974722e-17,  6.299510e-23,  1.584893e-12],
                          [9.979888e-09,  5.011872e-03,  1.991250e-11,  1.991250e-13,  7.927307e-17,  1.581706e-22,  1.995262e-12],
                          [9.974629e-09,  3.981072e-03,  2.505514e-11,  3.154255e-13,  1.580872e-16,  3.970971e-22,  2.511886e-12],
                          [9.967979e-09,  3.162278e-03,  3.152152e-11,  4.995824e-13,  3.152152e-16,  9.967979e-22,  3.162278e-12],
                          [9.959559e-09,  2.511886e-03,  3.964972e-11,  7.911159e-13,  6.284057e-16,  2.501728e-21,  3.981072e-12],
                          [9.948884e-09,  1.995262e-03,  4.986254e-11,  1.252490e-12,  1.252490e-15,  6.277321e-21,  5.011872e-12],
                          [9.935327e-09,  1.584893e-03,  6.268768e-11,  1.982358e-12,  2.495641e-15,  1.574643e-20,  6.309573e-12],
                          [9.918077e-09,  1.258925e-03,  7.878208e-11,  3.136371e-12,  4.970813e-15,  3.948457e-20,  7.943282e-12],
                          [9.896070e-09,  1.000000e-03,  9.896070e-11,  4.959784e-12,  9.896070e-15,  9.896070e-20,  1.000000e-11],
                          [9.867912e-09,  7.943282e-04,  1.242297e-10,  7.838361e-12,  1.968907e-14,  2.478707e-19,  1.258925e-11],
                          [9.831761e-09,  6.309573e-04,  1.558229e-10,  1.237745e-11,  3.914094e-14,  6.203421e-19,  1.584893e-11],
                          [9.785159e-09,  5.011872e-04,  1.952396e-10,  1.952396e-11,  7.772628e-14,  1.550843e-18,  1.995262e-11],
                          [9.724817e-09,  3.981072e-04,  2.442764e-10,  3.075257e-11,  1.541280e-13,  3.871519e-18,  2.511886e-11],
                          [9.646306e-09,  3.162278e-04,  3.050430e-10,  4.834605e-11,  3.050430e-13,  9.646306e-18,  3.162278e-11],
                          [9.543650e-09,  2.511886e-04,  3.799396e-10,  7.580791e-11,  6.021636e-13,  2.397257e-17,  3.981072e-11],
                          [9.408808e-09,  1.995262e-04,  4.715575e-10,  1.184499e-10,  1.184499e-12,  5.936557e-17,  5.011872e-11],
                          [9.231057e-09,  1.584893e-04,  5.824403e-10,  1.841838e-10,  2.318737e-12,  1.463024e-16,  6.309573e-11],
                          [8.996391e-09,  1.258925e-04,  7.146087e-10,  2.844909e-10,  4.508876e-12,  3.581528e-16,  7.943282e-11],
                          [8.687200e-09,  1.000000e-04,  8.687200e-10,  4.353914e-10,  8.687200e-12,  8.687200e-16,  1.000000e-10],
                          [8.282802e-09,  7.943282e-05,  1.042743e-09,  6.579264e-10,  1.652636e-11,  2.080546e-15,  1.258925e-10],
                          [7.761784e-09,  6.309573e-05,  1.230160e-09,  9.771507e-10,  3.090022e-11,  4.897355e-15,  1.584893e-10],
                          [7.107334e-09,  5.011872e-05,  1.418100e-09,  1.418100e-09,  5.645556e-11,  1.126437e-14,  1.995262e-10],
                          [6.316045e-09,  3.981072e-05,  1.586519e-09,  1.997309e-09,  1.001026e-10,  2.514463e-14,  2.511886e-10],
                          [5.408189e-09,  3.162278e-05,  1.710220e-09,  2.710515e-09,  1.710220e-10,  5.408189e-14,  3.162278e-10],
                          [4.433496e-09,  2.511886e-05,  1.765007e-09,  3.521651e-09,  2.797347e-10,  1.113644e-13,  3.981072e-10],
                          [2.511886e-09,  1.995262e-05,  1.258925e-09,  3.162278e-09,  3.162278e-10,  1.584893e-13,  5.011872e-10],
                          [1.258925e-09,  1.584893e-05,  7.943282e-10,  2.511886e-09,  3.162278e-10,  1.995262e-13,  6.309573e-10],
                          [6.309573e-10,  1.258925e-05,  5.011872e-10,  1.995262e-09,  3.162278e-10,  2.511886e-13,  7.943282e-10],
                          [3.162278e-10,  1.000000e-05,  3.162278e-10,  1.584893e-09,  3.162278e-10,  3.162278e-13,  1.000000e-09],
                          [1.584893e-10,  7.943282e-06,  1.995262e-10,  1.258925e-09,  3.162278e-10,  3.981072e-13,  1.258925e-09],
                          [7.943282e-11,  6.309573e-06,  1.258925e-10,  1.000000e-09,  3.162278e-10,  5.011872e-13,  1.584893e-09],
                          [3.981072e-11,  5.011872e-06,  7.943282e-11,  7.943282e-10,  3.162278e-10,  6.309573e-13,  1.995262e-09],
                          [1.995262e-11,  3.981072e-06,  5.011872e-11,  6.309573e-10,  3.162278e-10,  7.943282e-13,  2.511886e-09],
                          [1.000000e-11,  3.162278e-06,  3.162278e-11,  5.011872e-10,  3.162278e-10,  1.000000e-12,  3.162278e-09],
                          [5.011872e-12,  2.511886e-06,  1.995262e-11,  3.981072e-10,  3.162278e-10,  1.258925e-12,  3.981072e-09],
                          [2.511886e-12,  1.995262e-06,  1.258925e-11,  3.162278e-10,  3.162278e-10,  1.584893e-12,  5.011872e-09],
                          [1.258925e-12,  1.584893e-06,  7.943282e-12,  2.511886e-10,  3.162278e-10,  1.995262e-12,  6.309573e-09],
                          [6.309573e-13,  1.258925e-06,  5.011872e-12,  1.995262e-10,  3.162278e-10,  2.511886e-12,  7.943282e-09],
                          [3.162278e-13,  1.000000e-06,  3.162278e-12,  1.584893e-10,  3.162278e-10,  3.162278e-12,  1.000000e-08],
                          [1.584893e-13,  7.943282e-07,  1.995262e-12,  1.258925e-10,  3.162278e-10,  3.981072e-12,  1.258925e-08],
                          [7.943282e-14,  6.309573e-07,  1.258925e-12,  1.000000e-10,  3.162278e-10,  5.011872e-12,  1.584893e-08],
                          [3.981072e-14,  5.011872e-07,  7.943282e-13,  7.943282e-11,  3.162278e-10,  6.309573e-12,  1.995262e-08],
                          [1.995262e-14,  3.981072e-07,  5.011872e-13,  6.309573e-11,  3.162278e-10,  7.943282e-12,  2.511886e-08],
                          [1.000000e-14,  3.162278e-07,  3.162278e-13,  5.011872e-11,  3.162278e-10,  1.000000e-11,  3.162278e-08],
                          [5.011872e-15,  2.511886e-07,  1.995262e-13,  3.981072e-11,  3.162278e-10,  1.258925e-11,  3.981072e-08],
                          [2.511886e-15,  1.995262e-07,  1.258925e-13,  3.162278e-11,  3.162278e-10,  1.584893e-11,  5.011872e-08],
                          [1.258925e-15,  1.584893e-07,  7.943282e-14,  2.511886e-11,  3.162278e-10,  1.995262e-11,  6.309573e-08],
                          [6.309573e-16,  1.258925e-07,  5.011872e-14,  1.995262e-11,  3.162278e-10,  2.511886e-11,  7.943282e-08],
                          [3.162278e-16,  1.000000e-07,  3.162278e-14,  1.584893e-11,  3.162278e-10,  3.162278e-11,  1.000000e-07],
                          [1.584893e-16,  7.943282e-08,  1.995262e-14,  1.258925e-11,  3.162278e-10,  3.981072e-11,  1.258925e-07],
                          [7.943282e-17,  6.309573e-08,  1.258925e-14,  1.000000e-11,  3.162278e-10,  5.011872e-11,  1.584893e-07],
                          [3.981072e-17,  5.011872e-08,  7.943282e-15,  7.943282e-12,  3.162278e-10,  6.309573e-11,  1.995262e-07],
                          [1.995262e-17,  3.981072e-08,  5.011872e-15,  6.309573e-12,  3.162278e-10,  7.943282e-11,  2.511886e-07],
                          [1.000000e-17,  3.162278e-08,  3.162278e-15,  5.011872e-12,  3.162278e-10,  1.000000e-10,  3.162278e-07],
                          [5.011872e-18,  2.511886e-08,  1.995262e-15,  3.981072e-12,  3.162278e-10,  1.258925e-10,  3.981072e-07],
                          [2.511886e-18,  1.995262e-08,  1.258925e-15,  3.162278e-12,  3.162278e-10,  1.584893e-10,  5.011872e-07],
                          [1.258925e-18,  1.584893e-08,  7.943282e-16,  2.511886e-12,  3.162278e-10,  1.995262e-10,  6.309573e-07],
                          [6.309573e-19,  1.258925e-08,  5.011872e-16,  1.995262e-12,  3.162278e-10,  2.511886e-10,  7.943282e-07],
                          [3.162278e-19,  1.000000e-08,  3.162278e-16,  1.584893e-12,  3.162278e-10,  3.162278e-10,  1.000000e-06],
                          [1.584893e-19,  7.943282e-09,  1.995262e-16,  1.258925e-12,  3.162278e-10,  3.981072e-10,  1.258925e-06],
                          [7.943282e-20,  6.309573e-09,  1.258925e-16,  1.000000e-12,  3.162278e-10,  5.011872e-10,  1.584893e-06],
                          [3.981072e-20,  5.011872e-09,  7.943282e-17,  7.943282e-13,  3.162278e-10,  6.309573e-10,  1.995262e-06],
                          [1.995262e-20,  3.981072e-09,  5.011872e-17,  6.309573e-13,  3.162278e-10,  7.943282e-10,  2.511886e-06],
                          [1.000000e-20,  3.162278e-09,  3.162278e-17,  5.011872e-13,  3.162278e-10,  1.000000e-09,  3.162278e-06],
                          [5.011872e-21,  2.511886e-09,  1.995262e-17,  3.981072e-13,  3.162278e-10,  1.258925e-09,  3.981072e-06],
                          [2.511886e-21,  1.995262e-09,  1.258925e-17,  3.162278e-13,  3.162278e-10,  1.584893e-09,  5.011872e-06],
                          [1.258925e-21,  1.584893e-09,  7.943282e-18,  2.511886e-13,  3.162278e-10,  1.995262e-09,  6.309573e-06],
                          [6.309573e-22,  1.258925e-09,  5.011872e-18,  1.995262e-13,  3.162278e-10,  2.511886e-09,  7.943282e-06],
                          [3.162278e-22,  1.000000e-09,  3.162278e-18,  1.584893e-13,  3.162278e-10,  3.162278e-09,  1.000000e-05],
                          [1.584893e-22,  7.943282e-10,  1.995262e-18,  1.258925e-13,  3.162278e-10,  3.981072e-09,  1.258925e-05],
                          [7.943282e-23,  6.309573e-10,  1.258925e-18,  1.000000e-13,  3.162278e-10,  5.011872e-09,  1.584893e-05],
                          [3.981072e-23,  5.011872e-10,  7.943282e-19,  7.943282e-14,  3.162278e-10,  6.309573e-09,  1.995262e-05],
                          [1.995262e-23,  3.981072e-10,  5.011872e-19,  6.309573e-14,  3.162278e-10,  7.943282e-09,  2.511886e-05],
                          [9.693419e-24,  3.162278e-10,  3.065328e-19,  4.858218e-14,  3.065328e-10,  9.693419e-09,  3.162278e-05],
                          [3.883510e-24,  2.511886e-10,  1.546053e-19,  3.084782e-14,  2.450329e-10,  9.754936e-09,  3.981072e-05],
                          [1.553886e-24,  1.995262e-10,  7.787878e-20,  1.956227e-14,  1.956227e-10,  9.804358e-09,  5.011872e-05],
                          [6.211126e-25,  1.584893e-10,  3.918956e-20,  1.239283e-14,  1.560164e-10,  9.843971e-09,  6.309573e-05],
                          [2.480655e-25,  1.258925e-10,  1.970454e-20,  7.844519e-15,  1.243273e-10,  9.875665e-09,  7.943282e-05],
                          [9.900985e-26,  1.000000e-10,  9.900985e-21,  4.962247e-15,  9.900985e-11,  9.900985e-09,  1.000000e-04],
                          [3.949697e-26,  7.943282e-11,  4.972374e-21,  3.137356e-15,  7.880681e-11,  9.921190e-09,  1.258925e-04],
                          [1.574956e-26,  6.309573e-11,  2.496136e-21,  1.982752e-15,  6.270011e-11,  9.937298e-09,  1.584893e-04],
                          [6.278108e-27,  5.011872e-11,  1.252647e-21,  1.252647e-15,  4.986878e-11,  9.950130e-09,  1.995262e-04],
                          [2.501926e-27,  3.981072e-11,  6.284554e-22,  7.911784e-16,  3.965285e-11,  9.960346e-09,  2.511886e-04],
                          [9.968476e-28,  3.162278e-11,  3.152309e-22,  4.996073e-16,  3.152309e-11,  9.968476e-09,  3.162278e-04],
                          [3.971097e-28,  2.511886e-11,  1.580922e-22,  3.154354e-16,  2.505593e-11,  9.974944e-09,  3.981072e-04],
                          [1.581737e-28,  1.995262e-11,  7.927465e-23,  1.991289e-16,  1.991289e-11,  9.980087e-09,  5.011872e-04],
                          [6.299589e-29,  1.584893e-11,  3.974772e-23,  1.256933e-16,  1.582385e-11,  9.984176e-09,  6.309573e-04],
                          [2.508728e-29,  1.258925e-11,  1.992754e-23,  7.933295e-17,  1.257343e-11,  9.987426e-09,  7.943282e-04],
                          [9.990010e-30,  1.000000e-11,  9.990010e-24,  5.006865e-17,  9.990010e-12,  9.990010e-09,  1.000000e-03],
                          [3.977912e-30,  7.943282e-12,  5.007894e-24,  3.159768e-17,  7.936978e-12,  9.992063e-09,  1.258925e-03],
                          [1.583894e-30,  6.309573e-12,  2.510303e-24,  1.994004e-17,  6.305595e-12,  9.993694e-09,  1.584893e-03],
                          [6.306413e-31,  5.011872e-12,  1.258295e-24,  1.258295e-17,  5.009362e-12,  9.994991e-09,  1.995262e-03],
                          [2.510887e-31,  3.981072e-12,  6.307063e-25,  7.940121e-18,  3.979487e-12,  9.996021e-09,  2.511886e-03],
                          [9.996839e-32,  3.162278e-12,  3.161278e-25,  5.010288e-18,  3.161278e-12,  9.996839e-09,  3.162278e-03],
                          [3.980072e-32,  2.511886e-12,  1.584495e-25,  3.161484e-18,  2.511256e-12,  9.997489e-09,  3.981072e-03],
                          [1.584577e-32,  1.995262e-12,  7.941698e-26,  1.994864e-18,  1.994864e-12,  9.998005e-09,  5.011872e-03],
                          [6.308574e-33,  1.584893e-12,  3.980441e-26,  1.258726e-18,  1.584642e-12,  9.998415e-09,  6.309573e-03],
                          [2.511570e-33,  1.258925e-12,  1.995011e-26,  7.942282e-19,  1.258767e-12,  9.998741e-09,  7.943282e-03],
                          [9.999000e-34,  1.000000e-12,  9.999000e-27,  5.011371e-19,  9.999000e-13,  9.999000e-09,  1.000000e-02]])

    real_csolid = np.array([[0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             2.750524e-09, 
                             5.118433e-09, 
                             6.556114e-09, 
                             7.466107e-09, 
                             8.066433e-09, 
                             8.477946e-09, 
                             8.769570e-09, 
                             8.981949e-09, 
                             9.139962e-09, 
                             9.259442e-09, 
                             9.350858e-09, 
                             9.421386e-09, 
                             9.476091e-09, 
                             9.518642e-09, 
                             9.551745e-09, 
                             9.577422e-09, 
                             9.597196e-09, 
                             9.612212e-09, 
                             9.623327e-09, 
                             9.631168e-09, 
                             9.636172e-09, 
                             9.638620e-09, 
                             9.638650e-09, 
                             9.636269e-09, 
                             9.631352e-09, 
                             9.623641e-09, 
                             9.612725e-09, 
                             9.598025e-09, 
                             9.578757e-09, 
                             9.553897e-09, 
                             9.522119e-09, 
                             9.481733e-09, 
                             9.430588e-09, 
                             9.365959e-09, 
                             9.284406e-09, 
                             9.181585e-09, 
                             9.052020e-09, 
                             8.888813e-09, 
                             8.683271e-09, 
                             8.424449e-09, 
                             8.098563e-09, 
                             7.688259e-09, 
                             7.171686e-09, 
                             6.521336e-09, 
                             5.702575e-09, 
                             4.671800e-09, 
                             3.374119e-09, 
                             1.740427e-09, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00, 
                             0.000000e+00]])

    real_sindex = np.array([3.159103e-08,
                            6.301590e-08,
                            1.256918e-07,
                            2.506835e-07,
                            4.999157e-07,
                            9.967979e-07,
                            1.987193e-06,
                            3.960722e-06,
                            7.891911e-06,
                            1.571909e-05,
                            3.129412e-05,
                            6.226232e-05,
                            1.237745e-04,
                            2.457921e-04,
                            4.873954e-04,
                            9.646306e-04,
                            1.904209e-03,
                            3.745714e-03,
                            7.332489e-03,
                            1.425832e-02,
                            2.747134e-02,
                            5.226095e-02,
                            9.771507e-02,
                            1.785282e-01,
                            3.165521e-01,
                            5.408189e-01,
                            8.845988e-01,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            1.000000e+00,
                            9.693419e-01,
                            7.748621e-01,
                            6.186132e-01,
                            4.933673e-01,
                            3.931573e-01,
                            3.130966e-01,
                            2.492090e-01,
                            1.982752e-01,
                            1.576989e-01,
                            1.253933e-01,
                            9.968476e-02,
                            7.923379e-02,
                            6.297009e-02,
                            5.003942e-02,
                            3.976066e-02,
                            3.159119e-02,
                            2.509893e-02,
                            1.994004e-02,
                            1.584099e-02,
                            1.258424e-02,
                            9.996839e-03,
                            7.941288e-03,
                            6.308315e-03,
                            5.011078e-03,
                            3.980571e-03,
                            3.161961e-03])
    return real_csol, real_csolid.T, real_sindex
